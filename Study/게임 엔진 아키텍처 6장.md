# 게임 엔진 아키텍처를 읽고 깨달은 것 (6장)

- 파일 시스템
  
  - OS의 API를 감쌌을 때의 장점
  경로를 표현하는 방법도 OS마다 차이가 존재하므로, 일관성을 보장하기 위해서라도 OS의 함수를 감싸야 한다. 그 외에도 감쌀 경우 추가적인 장점이 존재한다.
    - 다른 플랫폼이라도 똑같은 동작을 보장할 수 있다.
    - 엔진에서 필요한 기능만 갖게 단순화할 수 있다.
    - 확장 기능을 지원할 수 있다. (대표적으로 비동기 파일 I/O)

  - CWD  
  CWD란 UNIX, Windows에서 모두 지원하는 개념으로, 현재 작업 디렉터리 (Current Working Directory)의 약자이다. 상대 경로는 CWD부터 시작하는 경로이다. (절대 경로는 CWD가 루트 디렉터리인 것이다.)

  - 비동기 파일 I/O (Streaming)  
  표준 C 라이브러리의 파일 I/O는 모두 동기적으로 동작한다. 그러나 게임 엔진은 비동기적인 파일 I/O를 지원해야 한다.  
  Streaming이 지원해야 할 기능은 다음과 같다.  
    - 비동기적 I/O
    - I/O 동작이 완료되기를 기다리는 기능
    - 비동기 I/O에 우선순위를 부여하는 기능

  - 비동기 파일 I/O의 구현 방법  
  Streaming은 생산자-소비자 패턴을 활용하여 구현하게 된다. I/O가 끝날 때까지 기다리는 기능은 세마포어를 이용해서 구현할 수 있다.

- 리소스 매니저
  
  - 게임에서 사용하는 자원 중 원래 형식을 그대로 쓸 수 있는 것이 별로 없기에, 게임에서 쓸 수 있게 하는 **Asset Conditioning Pipeline (ACP)**을 거쳐서 사용한다.  
  
  - ACP를 거치는 자원들은 자신을 어떻게 처리해야 해야 하는지 알려주는 메타 데이터가 존재한다. 이런 메타 데이터를 관리하기 위해서는 **리소스 데이터베이스**가 필요하다. 리소스 데이터베이스는 설정처럼 다양한 데이터베이스를 선택할 수 있다.

  - 리소스 데이터베이스는 다음과 같은 기능을 제공해야 한다.
    - 일반적인 데이터베이스처럼 삽입, 삭제, 조회, 수정이 가능해야 한다. 일관된 방식으로 처리할 수 있으면 가장 좋다.
    - 리소스의 원본 파일을 옮길 수 있어야 한다.
    - 리소스들끼리 교차 참조할 수 있으면서, 참조 무결성을 유지해야 한다.
    - 변경 사항을 관리하고, 작업자와 작업 사유에 대한 기록을 갖춰야 한다.
    - 다양한 질의를 처리할 수 있으면 좋다.
